# "Under The Weather" Spotify® Playlist Maker

## Задача ##
Разработать веб-приложение для генерации плейлистов на Spotify на основе пользовательский предпочтений и соответствующих текущей погоде. 
Приложение должно включать простой фронтенд (разметка и стили + виджет погоды) и Django - бэкенд, 
поддержку аутентификации через Spotify API, алгоритм для подбора треков, кэширование данных, тесты, и должно быть развернуто на удаленном сервере в контейнере Docker compose с настройкой CI/CD.
## Описание проекта
Это веб-приложение помогает пользователям Spotify (как бесплатной, так и премиум-версии) создавать персонализированные плейлисты с треками, соответствующими погодным условиям в локации пользователя.

**Формирование плейлиста**

Формирование плейлиста делится на 3 этапа:
- **Анализ пользовательских музыкальных вкусов и извлечение наиболее популярных жанров**
  
  Ключевой параметр для создания рекомендательных плейлистов в Spotify - это "жанр".
Пока пользователь загружает главную страницу, алгоритм на бэкенде сканирует наиболее прослушиваемых исполнителей и извлекает музыкальные жанры, к которым они принадлежат. Затем он определяет топ-3 жанра (например, "рок", "поп", "танцевальная музыка"). 
Чтобы добавить немного разнообразия, алгоритм добавляет 2 случайных жанра (это может быть что-то вроде "k-pop" или "саундтрек"), чтобы у пользователя была возможность открыть для себя что-то новое. Итак, у нас есть 5 жанров для работы!

- **Получение данных о погоде по локации пользователя**

  Приложение попросит разрешение на получение геокоординат, чтобы алгоритм на бэкенде мог получить данные о погодных условия с сайта www.openweathermap.org. 

- **Сопоставление данных о погоде с определёнными аудиохарактеристиками**

  Допустим, идёт дождь, поэтому вы, возможно, чувствуете себя немного подавленным и не хотите слушать что-то слишком быстрое и громкое (хотя это субъективно). 
Приложение постарается найти треки с низкими показателями танцевальности, энергии, громкости и валентности из тех 5 жанров, которые были выбраны ранее плюс 10 треков, в названиях которых есть слово "дождь". Вуаля! Список из 50 треков готов!

**Создание плейлиста**

К моменту полной загрузки главной страницы с приветствием авторизованного пользователя и формой для создания плейлиста у нас уже есть сформированный плейлист из 50 треков (эта задача была выполнена Celery в фоне).
Осталось только ввести в поле формы желаемое название для плейлиста и, после прохождения валидации уникальности имени, пользователь будет перенаправлен на страницу со ссылкой на плейлист  
(это означает, что на Spotify уже создан плейлист с выбранным именем и наполнен ранее подобранными аудиотреками).

**Прослушиавание плейлиста**

После нажатия на кнопку "Listen on Spotify" пользователь перенаправляется на www.spotify.com прямо на страницу с созданным плейлистом.

## Функциональные возможности

- **Аутентификация пользователей**: Пользователи проходят аутентификацию через систему Spotify, предоставляя доступ только к своим профилям.
- **Интеграция с Spotify API**: Приложение подключается к Spotify API, что позволяет пользователям просматривать свои музыкальные библиотеки и создавать плейлисты.
- **Интеграция с OpenWeather API**: Приложение использует OpenWeather API для получения данных о текущей погоде на основе местоположения пользователя. Эти данные затем используются для генерации плейлистов, соответствующих текущей погоде.
- **Рекомендации на основе погоды**: Используется умный алгоритм, который связывает текущие погодные условия с характеристиками треков (такими как танцевальность, громкость, энергия, настроение, популярность) из метаданных Spotify.
- **Динамическая генерация плейлистов**: Плейлисты создаются динамически после получения данных о местоположении и погоде.
- **Интеграция с Celery**: Обработка асинхронных задач с использованием Celery для получения данных о погоде и поиска треков.
- **Redis как брокер сообщений и кэш**: Redis используется в качестве брокера сообщений для Celery и как система кэширования для Django.
- **Отзывчивый интерфейс**: Приложение имеет удобный интерфейс, реализованный с помощью шаблонов Django, CSS Bootstrap, а также JavaScript/jQuery для динамических взаимодействий.
- **Docker для развертывания**: Приложение упаковано в Docker-контейнеры для упрощения развертывания и масштабирования.

### Краткое описание эндпоинтов:
1. **/** — точка входа (перенаправляет на страницу аутентификации или на главную страницу).
2. **/authenticate** — обработка аутентификации пользователя через Spotify.
3. **/login/success** — страница успешной авторизации.
4. **/create-playlist/** — страница с виджетом погоды и формой для создания плейлиста на основе погоды (главная страница приложения).
5. **/create-playlist/success** — страница с кнопкой для перехода по URL -адрес плейлиста в Spofity
6. **/contacts** — контактная информация.
7. **/about** — страница информации о приложении.

## Установка и настройка

### Требования:
- Python 3.8+
- Django 4.0+
- Celery
- Redis
- Docker
- Spotify API
- OpenWeather API

### Шаги установки:
Клонируйте репозиторий:
```
git clone https://github.com/ТВОЙ-USERNAME/UnderTheWeatherPlaylistMaker.git
```
Перейдите в папку проекта:
```
cd UnderTheWeatherPlaylistMaker
```
Настройте виртуальное окружение:

```
python -m venv venv
source venv/bin/activate  # На Mac/Linux
venv\Scripts\activate  # На Windows
```
Установите зависимости:

```
pip install -r requirements.txt
```

Настройте переменные окружения для аутентификации через Spotify API и доступа к OpenWeather API.
Создайте файл .env в корне проекта и добавьте в него следующие строки:

```
SPOTIFY_CLIENT_ID=<your-spotify-client-id>
SPOTIFY_CLIENT_SECRET=<your-spotify-client-secret>
SPOTIFY_REDIRECT_URI=<your-redirect-uri>
OPENWEATHER_API_KEY=<ваш-ключ-OpenWeather-API>
```
Настройте Redis и запустите его локально или через Docker:

```
docker run -p 6379:6379 redis
```
Запустите Celery:
```
celery -A config worker --loglevel=info
```
Выполните миграции для базы данных:

```
python manage.py migrate
```

Запустите сервер Django:

```
python manage.py runserver
```


### Развертывание в Docker ###
Приложение можно развернуть в Docker, выполнив следующие шаги:

- Убедитесь, что у вас установлен Docker и Docker Compose.

- Запустите сборку и поднимите контейнеры:
```
docker compose up --build
```

## Тестирование ##
Для запуска тестов используйте Django test runner:

```
python manage.py test
```
## Контакты ##
Для вопросов или поддержки, свяжитесь через почту: admitry424@gmail.com

